<!DOCTYPE html>
<html>
<head> <title>cardsorter</title>
<meta charset=utf-8>
<!-- fuck google 
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.8/jquery-ui.min.js" type="text/javascript"></script>
<script src="http://jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.8/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script>
-->

<script src=js/jquery.js></script>
<script src=js/jquery-ui.min.js></script>

<link rel='shortcut icon' href="favicon.png"  />
<link rel=stylesheet href="css/style.css" media=screen />
<link rel=stylesheet href="css/print.css" media=print />


<script>

$(document).ready(function(){


  if(localStorage.stickies){
    var stickies = JSON.parse(localStorage.stickies);   
    $.each(stickies, function(i,sticky){
      $('<div>', {
        'css': {'position': 'absolute', 'top': sticky.top, 'left': sticky.left} ,
        'class': 'sticky',
        'text': sticky.text
      }).appendTo('#board')
    })
  }


  $('.sticky').draggable();

  $('p#help_content').hide(); 

  $('textarea').focus();

  $('#toggle_help').toggle(
   function(){ $('#help_content').show(); $('#toggle_help').html('close help'); },
   function(){ $('#help_content').hide(); $('#toggle_help').html('show help'); }
  )

  $('textarea').keyup(function(ev){

    if( ev.which == 13 && $('textarea').val().length > 0){

        $('<div></div>', {
          'text': $.trim($('textarea').val()),
          'class': 'sticky'
        })
        .css({
          //'left': Math.floor(Math.random() * 80) + '%',
          //'top': Math.floor(Math.random() * 80) + '%',
          //'left': Math.floor(Math.random() * $('#board').width()),
          //'top': Math.floor(Math.random() * $('#board').height())
          'left': Math.floor(Math.random() * $('#board').width()) * .6 + 'px',
          'top': Math.floor(Math.random() * $('#board').height()) * .6 + 'px',
          'position': 'absolute' 
        })
        .appendTo($('#board'));

        $('textarea').val('').focus();

        $('.sticky').draggable({ });

    }

  });


  $( "div.sticky" ).live('dblclick', function(){ 
    $(this).addClass('hidden') ;
    $('.sticky').draggable({ });
  } ) ;


  $('#save').live('click', function(){ 
    var stickies = []; 
    $.each($('div.sticky').not('.hidden'), function(i, sticky) { 
      stickies.push({  
        'top': $(this).css('top'),
        'left': $(this).css('left'),
        'position': $(this).css('position'),
        'text': $(this).text(),
      }) 
    })  
  
    localStorage.stickies = JSON.stringify(stickies);
  })




})

</script>
</head>

<body>

<h1>card sorter</h1>
<div id=board></div>
<textarea></textarea>

<button id=save>save</button>
<div id=help>
<p id=help_content>Type in the box and press enter to create a new note. Double click a note to delete it. Click save to persist your notes across sessions. </p>
<p><a id=toggle_help href=#toggle_help>show help</a></p>
</div>
</body>
</html>
